# Annotate DeepLIFT Windows

> **ğŸ§¬ Variant Annotation and Phenotype Validation from DeepLIFT-identified Genomic Regions**

This tool annotates genetic variants identified by DeepLIFT in the Neural Ancestry Predictor, providing functional insights through VEP (Variant Effect Predictor) annotations and API-based gene/rsID information retrieval.

## Table of Contents

- [Overview](#overview)
- [Installation](#installation)
- [Quick Start](#quick-start)
- [Configuration](#configuration)
- [Input Format](#input-format)
- [Command-Line Options](#command-line-options)
- [Output Files](#output-files)
- [Pipeline Workflow](#pipeline-workflow)
- [Key Features](#key-features)
- [Examples](#examples)
- [API Integration](#api-integration)
- [Troubleshooting](#troubleshooting)

---

## Overview

### What does this tool do?

The **annotate_deeplift_windows.py** script takes the output from `neural_ancestry_predictor.py` (DeepLIFT analysis) and:

1. **Parses DNA sequences** extracted from DeepLIFT-identified genomic regions
2. **Fetches reference sequences** from UCSC Genome Browser (hg38)
3. **Calls variants** by comparing individual sequences against the reference
4. **Annotates variants** using Ensembl VEP REST API
5. **Retrieves gene information** from Ensembl, NCBI, and UniProt APIs
6. **Retrieves rsID information** from Ensembl Variation API
7. **Generates comprehensive reports** in Markdown and TSV formats

### Use Cases

- **Phenotype Validation**: Confirm that DeepLIFT-identified regions contain biologically relevant variants
- **Pigmentation Studies**: Identify variants in genes associated with skin pigmentation (e.g., SLC24A5, OCA2, TYR)
- **Longevity Research**: Discover variants in longevity-associated genes
- **Drug Target Discovery**: Identify functional variants for therapeutic intervention

---

## Installation

### Dependencies

```bash
pip install requests
```

### Requirements

- Python 3.8+
- Internet connection (for UCSC, VEP, Ensembl, NCBI, UniProt APIs)

---

## Quick Start

### Using YAML Configuration (Recommended)

```bash
# Run with configuration file
python3 annotate_deeplift_windows.py --config configs/annotate_deeplift.yaml

# Override specific parameters from command line
python3 annotate_deeplift_windows.py --config configs/annotate_deeplift.yaml --central-window 50
```

### Legacy Mode (Command Line Only)

```bash
# Basic usage
python3 annotate_deeplift_windows.py input.txt --outdir output_folder

# With central window filter
python3 annotate_deeplift_windows.py input.txt --outdir output_folder --central-window 50

# Skip VEP for fast analysis
python3 annotate_deeplift_windows.py input.txt --outdir output_folder --no-vep
```

---

## Configuration

### YAML Configuration File

The tool supports YAML configuration files for easier reproducibility and parameter management. Configuration files are stored in `configs/` directory.

**Example: `configs/annotate_deeplift.yaml`**

```yaml
# Input/Output
input:
  input_file: "/path/to/top_regions_deeplift.txt"

output:
  outdir: "my_analysis_results"

# Analysis Filters
filters:
  haplotype: "H1"        # H1, H2, or both
  central_window: 100    # null for no filter, or N for Â±(N/2)bp

# VEP Settings
vep:
  skip_vep: false
  batch_size: 100        # Max 200
  timeout: 90            # Seconds

# UCSC Settings
ucsc:
  timeout: 30            # Seconds

# API Settings
api:
  rate_limit: 0.34       # Seconds between API calls
  gene_timeout: 15       # Timeout for gene/rsID APIs
  max_rsids_to_fetch: 50 # Limit rsID lookups
```

### Configuration Sections

| Section | Description |
|---------|-------------|
| `input` | Path to input file from DeepLIFT analysis |
| `output` | Output directory for results |
| `filters` | Haplotype selection and central window filter |
| `vep` | VEP annotation settings (batch size, timeout, skip) |
| `ucsc` | UCSC API timeout |
| `api` | Rate limiting and timeout for gene/rsID APIs |

### Priority Order

Command-line arguments **override** YAML values, which **override** default values:

```
CLI arguments > YAML config > Default values
```

**Example:**
```bash
# YAML has central_window: 100, but CLI overrides to 50
python3 annotate_deeplift_windows.py --config configs/annotate_deeplift.yaml --central-window 50
```

### Creating a New Configuration

1. Copy the example configuration:
   ```bash
   cp configs/annotate_deeplift.yaml configs/my_experiment.yaml
   ```

2. Edit the new file with your parameters:
   ```bash
   vim configs/my_experiment.yaml
   ```

3. Run with your configuration:
   ```bash
   python3 annotate_deeplift_windows.py --config configs/my_experiment.yaml
   ```

---

## Input Format

The input file is generated by `neural_ancestry_predictor.py` with DeepLIFT enabled. It contains:

```
Top 5 RegiÃµes Mais Ativas (DeepLIFT)
================================================================================
Classe: AFR (250 amostras)
================================================================================

1. DDB1: valor_medio = 0.041459, chr11: 61,333,312
   IndivÃ­duo com maior valor: NA20355 (AFR/ASW, valor = 0.185202)
   Valores nas 5 regiÃµes: DDB1=0.18520, OCA2=0.05813, ...
   DNA H1 (1000bp centradas em chr11:61,333,312):
   >NA20355_H1_DDB1_center_61333312
   TTCCCATACTTTTTTTTTCATATTCTGAATTACTCCTTTTTTTAAATTGAGATGGGATCC
   ...
   DNA H2 (1000bp centradas em chr11:61,333,312):
   >NA20355_H2_DDB1_center_61333312
   ATTTTTCTGCAGAGAAGGTCCGAAGTTTTCATATTCTAGAAGAAGTCCATTACATTAAAC
   ...
```

Key elements parsed:
- **Gene name**: e.g., DDB1, OCA2, SLC24A5
- **Chromosome and center position**: e.g., chr11:61,333,312
- **Haplotype**: H1 or H2
- **Individual ID**: e.g., NA20355
- **DNA sequence**: FASTA format

---

## Command-Line Options

| Option | Default | Description |
|--------|---------|-------------|
| `--config` | `None` | YAML configuration file path |
| `input_txt` | (from YAML or required) | Input file from neural_ancestry_predictor.py |
| `--outdir` | `variant_annotation_out` | Output directory |
| `--haplotype` | `H1` | Which haplotype: `H1`, `H2`, or `both` |
| `--central-window` | `None` | Filter variants to Â±(N/2)bp from center |
| `--no-vep` | `false` | Skip VEP annotation (faster) |
| `--vep-batch-size` | `100` | VEP batch size (max 200) |
| `--vep-timeout` | `90` | VEP API timeout (seconds) |
| `--ucsc-timeout` | `30` | UCSC API timeout (seconds) |

> **Note:** When using `--config`, all parameters can be specified in the YAML file. Command-line arguments override YAML values.

### Central Window Filter

The `--central-window` option is crucial for focusing on the most relevant variants:

```bash
# Keep only variants within Â±25bp of DeepLIFT center
--central-window 50

# Keep only variants within Â±10bp of DeepLIFT center  
--central-window 20
```

**Example results:**
- Without filter: 7,472 variant occurrences
- With `--central-window 50`: 370 variant occurrences (95% reduction)

### Haplotype Selection

```bash
# Analyze only H1 (default)
--haplotype H1

# Analyze only H2
--haplotype H2

# Analyze both haplotypes
--haplotype both
```

---

## Output Files

The tool generates the following outputs in the specified directory:

### TSV Files

| File | Description |
|------|-------------|
| `parsed_records.tsv` | All parsed FASTA records with metadata |
| `variant_occurrences.tsv` | Every variant occurrence with sample, gene, position, distance to center |
| `unique_variants.tsv` | Deduplicated variants with minimum distance to center |
| `vep_annotated_variants.tsv` | VEP annotations (consequence, impact, rsIDs, etc.) |
| `summary_by_gene.tsv` | Aggregated statistics per gene |
| `summary_by_individual.tsv` | Aggregated statistics per individual |
| `summary_by_individual_gene.tsv` | Aggregated statistics per individualÃ—gene |

### Markdown Reports

| File | Description |
|------|-------------|
| `report_by_gene_by_individual.md` | Comprehensive report with tables, gene descriptions, and HIGH impact analysis |
| `phenotype_validation_report.md` | Focused report for phenotype validation with rsID annotations |

### Other Outputs

| File/Directory | Description |
|----------------|-------------|
| `reference_fasta/` | Reference sequences fetched from UCSC (one file per region) |
| `vep_chunks/` | Raw VEP JSON responses (for debugging) |
| `vep_annotations.all.json` | Aggregated VEP annotations |

---

## Pipeline Workflow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ANNOTATE DEEPLIFT WINDOWS                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚  1. PARSE INPUT                                                     â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                     â”‚
â”‚     â”‚ Input TXT from neural_ancestry_predictor â”‚                    â”‚
â”‚     â”‚ â†’ Extract FASTA sequences               â”‚                     â”‚
â”‚     â”‚ â†’ Parse gene, chrom, center, sample     â”‚                     â”‚
â”‚     â”‚ â†’ Detect window size automatically      â”‚                     â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â”‚
â”‚                           â†“                                         â”‚
â”‚  2. FETCH REFERENCE                                                 â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                     â”‚
â”‚     â”‚ UCSC REST API (hg38)                    â”‚                     â”‚
â”‚     â”‚ â†’ /getData/sequence                     â”‚                     â”‚
â”‚     â”‚ â†’ Cache per region                      â”‚                     â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â”‚
â”‚                           â†“                                         â”‚
â”‚  3. CALL VARIANTS                                                   â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                     â”‚
â”‚     â”‚ Compare sample vs reference             â”‚                     â”‚
â”‚     â”‚ â†’ SNVs: simple comparison               â”‚                     â”‚
â”‚     â”‚ â†’ Indels: Needleman-Wunsch alignment    â”‚                     â”‚
â”‚     â”‚ â†’ Calculate distance to DeepLIFT center â”‚                     â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â”‚
â”‚                           â†“                                         â”‚
â”‚  4. FILTER (optional)                                               â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                     â”‚
â”‚     â”‚ --central-window N                      â”‚                     â”‚
â”‚     â”‚ â†’ Keep only variants within Â±(N/2)bp    â”‚                     â”‚
â”‚     â”‚ â†’ Typically 90-95% reduction            â”‚                     â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â”‚
â”‚                           â†“                                         â”‚
â”‚  5. ANNOTATE (VEP)                                                  â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                     â”‚
â”‚     â”‚ Ensembl VEP REST API                    â”‚                     â”‚
â”‚     â”‚ â†’ Consequence terms                     â”‚                     â”‚
â”‚     â”‚ â†’ Impact (HIGH/MODERATE/LOW/MODIFIER)   â”‚                     â”‚
â”‚     â”‚ â†’ Gene symbols, rsIDs                   â”‚                     â”‚
â”‚     â”‚ â†’ Amino acid changes                    â”‚                     â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â”‚
â”‚                           â†“                                         â”‚
â”‚  6. FETCH ADDITIONAL INFO                                           â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                     â”‚
â”‚     â”‚ Gene Info (Ensembl, NCBI, UniProt)      â”‚                     â”‚
â”‚     â”‚ â†’ Description, function, biotype        â”‚                     â”‚
â”‚     â”‚ â†’ Expression strand (+/-)               â”‚                     â”‚
â”‚     â”‚                                         â”‚                     â”‚
â”‚     â”‚ rsID Info (Ensembl Variation)           â”‚                     â”‚
â”‚     â”‚ â†’ Clinical significance                 â”‚                     â”‚
â”‚     â”‚ â†’ Associated phenotypes                 â”‚                     â”‚
â”‚     â”‚ â†’ Minor allele frequency                â”‚                     â”‚
â”‚     â”‚                                         â”‚                     â”‚
â”‚     â”‚ HIGH Impact Details                     â”‚                     â”‚
â”‚     â”‚ â†’ Detailed analysis of severe variants  â”‚                     â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â”‚
â”‚                           â†“                                         â”‚
â”‚  7. GENERATE REPORTS                                                â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                     â”‚
â”‚     â”‚ report_by_gene_by_individual.md         â”‚                     â”‚
â”‚     â”‚ phenotype_validation_report.md          â”‚                     â”‚
â”‚     â”‚ Various TSV summaries                   â”‚                     â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Key Features

### 1. Automatic Window Size Detection

The tool automatically detects the window size from the input sequences. No need to specify it manually.

```
[INFO] Tamanho da janela detectado: 1000bp
```

### 2. Central Window Filtering

Focus analysis on the region where DeepLIFT identified the highest attribution:

```
[INFO] Filtro central: Â±25bp do centro (janela de 50bp)
[INFO] Variantes originais: 7472 ocorrÃªncias, 6524 Ãºnicas
[INFO] Variantes filtradas: 370 ocorrÃªncias, 328 Ãºnicas
[INFO] ReduÃ§Ã£o: 95.0% das ocorrÃªncias
```

### 3. HIGH Impact Variant Analysis

Detailed analysis of variants with HIGH functional impact:

| Consequence | Description |
|-------------|-------------|
| `stop_gained` | Introduces premature stop codon â†’ truncated protein |
| `splice_donor_variant` | Disrupts splice donor site â†’ abnormal splicing |
| `splice_acceptor_variant` | Disrupts splice acceptor site â†’ abnormal splicing |
| `frameshift_variant` | Shifts reading frame â†’ completely altered protein |

### 4. Expression Strand Information

The tool fetches the expression strand (+/-) for each gene, which can be compared with DeepLIFT visualizations:

```markdown
- **DDB1** (protein_coding, strand=-): damage specific DNA binding protein 1
- **SLC24A5** (protein_coding, strand=+): solute carrier family 24 member 5
```

### 5. Multi-Source Gene Information

Gene descriptions are fetched from multiple sources:
- **Ensembl**: Biotype, chromosome, strand
- **NCBI Gene**: Detailed functional descriptions
- **UniProt**: Protein function information

### 6. rsID Annotation

Known rsIDs are annotated with:
- **Clinical significance** (pathogenic, benign, uncertain, etc.)
- **Associated phenotypes**
- **Minor allele frequency (MAF)**

---

## Examples

### Example 1: Using YAML Configuration

```bash
# Run with default configuration
python3 annotate_deeplift_windows.py --config configs/annotate_deeplift.yaml
```

**Expected output:**
```
[INFO] ConfiguraÃ§Ã£o carregada de: configs/annotate_deeplift.yaml
[INFO] ConfiguraÃ§Ã£o efetiva:
       input_file: /path/to/top_regions_deeplift.txt
       outdir: my_analysis
       haplotype: H1
       central_window: 100
       skip_vep: False
       vep_batch_size: 100
       vep_timeout: 90
       ucsc_timeout: 30
[INFO] HaplÃ³tipo: H1 (filtrados 20 de 40 records)
[INFO] Tamanho da janela detectado: 2000bp
[INFO] Filtro central: Â±50bp do centro (janela de 100bp)
[INFO] Variantes filtradas: 1514 ocorrÃªncias, 1514 Ãºnicas
```

### Example 2: Override YAML Parameters

```bash
# Use YAML config but override central window
python3 annotate_deeplift_windows.py \
    --config configs/annotate_deeplift.yaml \
    --central-window 50 \
    --haplotype both
```

### Example 3: Legacy Mode (No YAML)

```bash
python3 annotate_deeplift_windows.py \
    top_regions_class_mean_AFR_250samples_deeplift.txt \
    --outdir pigmentation_analysis \
    --central-window 50 \
    --haplotype H1
```

**Expected output:**
```
[INFO] HaplÃ³tipo: H1 (filtrados 5 de 10 records)
[INFO] Tamanho da janela detectado: 1000bp
[INFO] Filtro central: Â±25bp do centro (janela de 50bp)
[INFO] Variantes filtradas: 182 ocorrÃªncias, 182 Ãºnicas
[API] Gene DDB1: fetched from Ensembl, NCBI, UniProt, strand=-
[API] Gene SLC24A5: fetched from Ensembl, NCBI, UniProt, strand=+
[INFO] Fetching detailed information for 5 HIGH impact variant(s)...
```

### Example 4: Fast Analysis (No VEP)

```bash
python3 annotate_deeplift_windows.py \
    input.txt \
    --outdir quick_analysis \
    --no-vep \
    --central-window 100
```

---

## API Integration

### APIs Used

| API | Purpose | Rate Limit |
|-----|---------|------------|
| **UCSC REST** | Reference sequence (hg38) | No strict limit |
| **Ensembl VEP** | Variant annotation | 200 variants/batch |
| **Ensembl Gene** | Gene info (biotype, strand) | ~3 req/sec |
| **NCBI Entrez** | Gene function descriptions | ~3 req/sec |
| **UniProt** | Protein function | ~3 req/sec |
| **Ensembl Variation** | rsID info (clinical, phenotypes) | ~3 req/sec |

### API Endpoints

```
UCSC:           https://api.genome.ucsc.edu/getData/sequence
Ensembl VEP:    https://rest.ensembl.org/vep/homo_sapiens/region
Ensembl Gene:   https://rest.ensembl.org/lookup/symbol/homo_sapiens/{gene}
Ensembl Var:    https://rest.ensembl.org/variation/human/{rsid}
NCBI Search:    https://eutils.ncbi.nlm.nih.gov/entrez/eutils/esearch.fcgi
NCBI Summary:   https://eutils.ncbi.nlm.nih.gov/entrez/eutils/esummary.fcgi
UniProt:        https://rest.uniprot.org/uniprotkb/search
```

---

## Troubleshooting

### Common Issues

**1. VEP timeout errors**

```bash
# Increase timeout
--vep-timeout 120

# Or skip VEP for quick analysis
--no-vep
```

**2. Too many variants**

```bash
# Use central window filter
--central-window 50

# Or use single haplotype
--haplotype H1
```

**3. API rate limiting**

The tool includes built-in rate limiting (~0.34s between requests). If you encounter 429 errors, wait and retry.

**4. Missing gene information**

Some genes may not have complete information in all databases. The tool gracefully handles missing data:

```
[WARN] Failed to fetch UniProt info for GENE123: 404 Not Found
```

### Interpreting Results

**Impact Levels:**

| Impact | Meaning | Examples |
|--------|---------|----------|
| HIGH | Likely loss of function | stop_gained, frameshift |
| MODERATE | May change protein function | missense_variant |
| LOW | Unlikely to change protein | synonymous_variant |
| MODIFIER | Non-coding or non-disruptive | intron_variant |

**Clinical Significance:**

| Value | Meaning |
|-------|---------|
| `pathogenic` | Known to cause disease |
| `likely_pathogenic` | Probably causes disease |
| `uncertain_significance` | Unknown effect |
| `likely_benign` | Probably harmless |
| `benign` | Known to be harmless |

---

## References

- **UCSC Genome Browser**: https://genome.ucsc.edu/
- **Ensembl VEP**: https://www.ensembl.org/vep
- **Ensembl REST API**: https://rest.ensembl.org/
- **NCBI Entrez**: https://www.ncbi.nlm.nih.gov/books/NBK25500/
- **UniProt**: https://www.uniprot.org/

---

## Version History

### v1.4 (2025-12)
- âœ¨ **YAML configuration file support** (`--config`)
- âœ¨ New `configs/annotate_deeplift.yaml` template
- âœ¨ All parameters configurable via YAML
- âœ¨ CLI arguments override YAML values
- âœ¨ Improved output with effective configuration display

### v1.3 (2025-12)
- âœ¨ HIGH impact variant detailed analysis
- âœ¨ Automatic window size detection
- âœ¨ Expression strand information

### v1.2 (2025-12)
- âœ¨ Dynamic gene info from APIs (Ensembl, NCBI, UniProt)
- âœ¨ Dynamic rsID info from Ensembl Variation
- âœ¨ Generic phenotype validation report

### v1.1 (2025-12)
- âœ¨ Central window filtering (--central-window)
- âœ¨ Haplotype selection (--haplotype)
- âœ¨ Distance to center calculation

### v1.0 (2025-12)
- âœ¨ Initial implementation
- âœ¨ VEP annotation
- âœ¨ Reference sequence fetching
- âœ¨ Variant calling

---

**Author**: Alberto F. De Souza  
**Date**: 2025-12  
**License**: MIT


