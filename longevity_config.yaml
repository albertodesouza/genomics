# ═══════════════════════════════════════════════════════════════════
# Configuration — Neural Longevity Dataset Builder
# ═══════════════════════════════════════════════════════════════════

project:
  name: "longevity_markers"
  description: "Discovery of longevity-associated genetic and epigenetic markers"
  output_dir: "longevity_dataset"

# ═══════════════════════════════════════════════════════════════════
# Data Sources
# ═══════════════════════════════════════════════════════════════════

data_sources:
  reference:
    fasta: "refs/reference.fa"   # resolved relative to this YAML directory
    name: "GRCh38"

  longevous:
    ena_project: "PRJEB31736"
    sample_range: [0, 10]
    label: 1

  non_longevous:
    ena_project: "PRJEB31736"
    sample_range: [10, 20]
    label: 0

# ═══════════════════════════════════════════════════════════════════
# Variant Selection
# ═══════════════════════════════════════════════════════════════════

variant_selection:
  initial_strategy: "first_longevous_sample"
  n_central_points: 10
  filters:
    min_quality: 30
    min_depth: 10
    filter_pass_only: true
    exclude_common: true
    max_allele_frequency: 0.5
  refinement:
    enabled: false
    method: "importance_ranking"
    top_k: 50

# ═══════════════════════════════════════════════════════════════════
# Sequence Extraction
# ═══════════════════════════════════════════════════════════════════

sequence_extraction:
  window_size: 2048
  center_on_variant: true
  use_alternate_allele: true

# ═══════════════════════════════════════════════════════════════════
# AlphaGenome
# ═══════════════════════════════════════════════════════════════════

alphagenome:
  api_key: "${ALPHAGENOME_API_KEY}"
  outputs:
    - "RNA_SEQ"
    - "CAGE"
    - "ATAC"
    - "CHIP_HISTONE"
    - "CHIP_TF"
    - "DNASE"
    - "PROCAP"
  ontology_terms:
    - "UBERON:0000955"  # Brain
    - "UBERON:0002107"  # Liver
    - "UBERON:0000948"  # Heart
    - "UBERON:0002048"  # Lung
    - "UBERON:0002113"  # Kidney
  cache_results: true
  cache_dir: "alphagenome_cache"
  batch_size: 10
  max_retries: 3
  retry_delay: 5

# ═══════════════════════════════════════════════════════════════════
# Dataset Assembly
# ═══════════════════════════════════════════════════════════════════

dataset:
  splits:
    train: 0.6
    validation: 0.2
    test: 0.2
  balance_classes: true
  random_seed: 42
  features:
    sequence:
      enabled: true
      encoding: "one_hot"
    position:
      enabled: true
      normalize: true
    alphagenome_predictions:
      enabled: true
      aggregation: "statistics"
      statistics: ["mean", "std", "min", "max", "median"]
    metadata:
      enabled: true
      fields:
        - "sample_id"
        - "chromosome"
        - "position"
        - "ref_allele"
        - "alt_allele"
        - "variant_type"
        - "genotype"
        - "allele_used"
  transforms:
    enabled: false
    methods: []

# ═══════════════════════════════════════════════════════════════════
# Pipeline Execution
# ═══════════════════════════════════════════════════════════════════

pipeline:
  steps:
    download_samples: true
    select_central_points: true
    extract_sequences: true
    run_alphagenome: true
    build_dataset: true
  parallel:
    enabled: true
    n_workers: 4
  resume_from_checkpoint: true
  checkpoint_frequency: 10

# ═══════════════════════════════════════════════════════════════════
# Resource Management
# ═══════════════════════════════════════════════════════════════════

resources:
  max_memory_gb: 32
  max_disk_gb: 100
  temp_dir: "/tmp/longevity_processing"

# ═══════════════════════════════════════════════════════════════════
# Logging & Debug
# ═══════════════════════════════════════════════════════════════════

logging:
  level: "INFO"
  log_file: "longevity_dataset/processing.log"
  console_output: true

debug:
  dry_run: false
  limit_samples: null
  save_intermediate: true
